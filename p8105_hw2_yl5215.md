p8105_hw2_yl5215
================

Load packages.

``` r
library(tidyverse)
library(readxl)
```

# Problem 2

Read and clean the Mr. Trash Wheel dataset:

1.  Specify the sheet in the Excel file to omit non-data entries (rows
    with notes / figures; columns containing notes) using arguments in
    `read_excel()`.
2.  Rename variable names for better clarity using
    `janitor::clean_names` and `rename()`.
3.  Omit rows that do not include dumpster-specific data using
    `drop_na()`.
4.  round the number of sports balls to the nearest integer and converts
    the result to an integer variable using `round()` and `as.integer`.

``` r
mr_wheel_df = 
  read_excel("data/Trash Wheel Collection Data.xlsx", sheet = 1, skip = 1, range = "A2:N549") %>%
  janitor::clean_names(dat = .) %>%
  rename(.data = ., weight = weight_tons, volume = volume_cubic_yards) %>%
  drop_na(dumpster, year, date) %>%
  mutate(.data = ., sports_balls = as.integer((round(sports_balls))))
```

Read and clean the Mr. Trash Wheel dataset by following similar steps:

``` r
prof_wheel_df = 
  read_excel("data/Trash Wheel Collection Data.xlsx", sheet = 2, skip = 1, range = "A2:M96") %>%
  janitor::clean_names(dat = .) %>%
  rename(.data = ., weight = weight_tons, volume = volume_cubic_yards) %>%
  drop_na(dumpster, year, date) %>%
  mutate(.data = ., dumpster = as.double(dumpster), year = as.character(year),  sports_balls = NA)
```

Combine `mr_wheel_df` and `prof_wheel_df` to produce a single tidy
dataset using `bind_rows`. To keep track of which Trash Wheel is which,
an additional variable to both datasets is added before combining.

``` r
mr_wheel_df  = 
  mr_wheel_df %>% 
  mutate(.data = ., trash_wheel_type = "mr_trash_wheel")
prof_wheel_df =
  prof_wheel_df %>%
  mutate(.data = ., trash_wheel_type = "prof_trash_wheel") 
combine_trash_df = bind_rows(mr_wheel_df, prof_wheel_df)
```

To make a summary about the datasets:

``` r
com_row = nrow(combine_trash_df)
com_col = ncol(combine_trash_df)

mr_row = nrow(mr_wheel_df)
pro_row = nrow(prof_wheel_df)
```

The datasets `mr_wheel_df` and `prof_wheel_df` include information about
trash collected by “Mr. Trash Wheel” and “Professor Trash Wheel”
respectively. `mr_wheel_df` contains 547 rows of data (observations) and
`prof_wheel_df` contains 94 rows of data (observations). The dataset
`combine_trash_df` is generated by combining `mr_wheel_df` and
`prof_wheel_df`, and it contains 641 rows (observations) and 15 columns.
The combined dataset `combine_trash_df` contains variables dumpster,
month, year, date, weight, volume, plastic_bottles, polystyrene,
cigarette_butts, glass_bottles, grocery_bags, chip_bags, sports_balls,
homes_powered, trash_wheel_type.

Below shows some example values of these variables:

``` r
head(combine_trash_df[1:5],5)
```

    ## # A tibble: 5 x 5
    ##   dumpster month year  date                weight
    ##      <dbl> <chr> <chr> <dttm>               <dbl>
    ## 1        1 May   2014  2014-05-16 00:00:00   4.31
    ## 2        2 May   2014  2014-05-16 00:00:00   2.74
    ## 3        3 May   2014  2014-05-16 00:00:00   3.45
    ## 4        4 May   2014  2014-05-17 00:00:00   3.1 
    ## 5        5 May   2014  2014-05-17 00:00:00   4.06

``` r
head(combine_trash_df[6:10],5)
```

    ## # A tibble: 5 x 5
    ##   volume plastic_bottles polystyrene cigarette_butts glass_bottles
    ##    <dbl>           <dbl>       <dbl>           <dbl>         <dbl>
    ## 1     18            1450        1820          126000            72
    ## 2     13            1120        1030           91000            42
    ## 3     15            2450        3100          105000            50
    ## 4     15            2380        2730          100000            52
    ## 5     18             980         870          120000            72

``` r
head(combine_trash_df[11:15],5)
```

    ## # A tibble: 5 x 5
    ##   grocery_bags chip_bags sports_balls homes_powered trash_wheel_type
    ##          <dbl>     <dbl>        <int>         <dbl> <chr>           
    ## 1          584      1162            7             0 mr_trash_wheel  
    ## 2          496       874            5             0 mr_trash_wheel  
    ## 3         1080      2032            6             0 mr_trash_wheel  
    ## 4          896      1971            6             0 mr_trash_wheel  
    ## 5          368       753            7             0 mr_trash_wheel

To compute the total weight of trash collected by Professor Trash Wheel
and the total number of sports balls collected by Mr. Trash Wheel in
2020:

``` r
total_weight_prof = 
  combine_trash_df %>%
  filter(trash_wheel_type == "prof_trash_wheel") %>%
  pull(weight) %>%
  sum
```

``` r
total_balls_mr_2020 = 
  combine_trash_df %>%
  filter(trash_wheel_type == "mr_trash_wheel", year == "2020") %>%
  pull(sports_balls) %>%
  na.omit() %>%
  sum
```

Therefore, the total weight of trash collected by Professor Trash Wheel
is 190.12 tons and the total number of sports balls collected by
Mr. Trash Wheel in 2020 is 856.

# Problem 3

First, clean the data in `pols-month.csv`. Use `separate()` to break up
the variable `mon` into integer variables `year`, `month`, and `day`;
replace month number with month name using `month.name`; create a
`president` variable taking values `gop` and `dem`, and remove
`prez_dem` and `prez_gop`, and `day`.

``` r
pols_month_df = 
  read_csv("data/fivethirtyeight_datasets/pols-month.csv") %>%
  janitor::clean_names(dat = .) %>%
  separate(data = ., mon, c("year", "month", "day"), sep = "-", convert = TRUE) %>%
  arrange(year, month) %>%
  mutate(.data = ., month = month.name[month], president = recode(prez_dem, "1" = "dem", "0" = "gop")) %>% 
  select(-prez_dem, -prez_gop, -day)
```

    ## Rows: 822 Columns: 9
    ## -- Column specification --------------------------------------------------------
    ## Delimiter: ","
    ## dbl  (8): prez_gop, gov_gop, sen_gop, rep_gop, prez_dem, gov_dem, sen_dem, r...
    ## date (1): mon
    ## 
    ## i Use `spec()` to retrieve the full column specification for this data.
    ## i Specify the column types or set `show_col_types = FALSE` to quiet this message.

Clean the data in `snp.csv` using a similar process to the above. The
`year` variable is converted for better clarity and easier analysis.
Arrange according to `year` and `month`, and organize so that `year` and
`month` are the leading columns.

``` r
snp_df = 
  read_csv("data/fivethirtyeight_datasets/snp.csv") %>%
  janitor::clean_names(dat = .) %>%
  separate(data = ., date, c("month", "day", "year"), sep = "/", convert = TRUE) %>%
  mutate(year = ifelse((year >= 50), year + 1900,
year + 2000),) %>%
  arrange(year, month) %>%
  mutate(.data = ., month = month.name[as.integer(month)]) %>% 
  select(year, month, close) 
```

    ## Rows: 787 Columns: 2
    ## -- Column specification --------------------------------------------------------
    ## Delimiter: ","
    ## chr (1): date
    ## dbl (1): close
    ## 
    ## i Use `spec()` to retrieve the full column specification for this data.
    ## i Specify the column types or set `show_col_types = FALSE` to quiet this message.

Tidy the unemployment data so that it can be merged with the previous
datasets. To do so, switch from “wide” to “long” format, and ensure that
key variables have the same name and that key variables take the same
values.

``` r
unemployment_df = 
  read_csv("data/fivethirtyeight_datasets/unemployment.csv") %>%
  janitor::clean_names(dat = .) %>%
  pivot_longer(
    data = .,
    jan:dec,
    names_to = "month",
    values_to = "unemployment"
  ) %>%
  drop_na(unemployment) %>%
  mutate(month = recode(month,
  'jan' = 'January',
  'feb' = 'February',
  'mar' = 'March',
  'apr' = 'April',
  'may' = 'May',
  'jun' = 'June',
  'jul' = 'July',
  'aug' = 'August',
  'sep' = 'September',
  'oct' = 'October',
  'nov' = 'November',
  'dec' = 'December'),
  year = as.integer(year), 
  month = as.character(month))
```

    ## Rows: 68 Columns: 13
    ## -- Column specification --------------------------------------------------------
    ## Delimiter: ","
    ## dbl (13): Year, Jan, Feb, Mar, Apr, May, Jun, Jul, Aug, Sep, Oct, Nov, Dec
    ## 
    ## i Use `spec()` to retrieve the full column specification for this data.
    ## i Specify the column types or set `show_col_types = FALSE` to quiet this message.

Join the datasets by merging `snp` into `pols`, and merging
`unemployment` into the result.

``` r
temp_merge_df =
  left_join(pols_month_df, snp_df, by = c("year" = "year", "month" = "month"))
result_merge_df = 
  left_join(temp_merge_df, unemployment_df, by = c("year" = "year", "month" = "month"))
```

To remove `NA`s in the resulting dataset:

``` r
result_fte_df = 
  result_merge_df %>%
  na.omit()
```

`pols_month_df` contains 822 rows of data (observations) and 9
variables. The variables are year, month, gov_gop, sen_gop, rep_gop,
gov_dem, sen_dem, rep_dem, president. Whether the politicians are
democratic or republican are indicated by `president`, `gov_gop`,
`sen_gop`, etc.

`snp_df` contains 787 rows of data (observations) and 3 variables. The
variables are year, month, close. The `close` variable shows the closing
values of the stock index on different dates.

`unemployment_df` contains 810 rows of data (observations) and 3
variables. The variables are year, month, unemployment. `unemployment`
shows unemployment rate in the associated times.

The cleaned, merged dataset `result_fte_df` has 786 rows of data
(observations) and 11 variables. It merges the variables from the 3
datasets `pols_month_df`, `snp_df`, and `unemployment_df`. The range of
years recorded in this dataset is 65.
